{% extends "superadmin/base.html" %}
{% block page_title %}Tenant #{{ tenant.id }} — {{ tenant.name }}{% endblock %}

{% block page_actions %}
  <a class="ff-chip ff-link me-2" href="{{ url_for('superadmin.tenants') }}"><i class="bi bi-arrow-left"></i> Voltar</a>
  <a class="ff-chip ff-link me-2" href="{{ url_for('superadmin.chat', tenant_id=tenant.id) }}"><i class="bi bi-chat-dots"></i> Chat</a>
  {% if tenant.is_blocked %}
    <form method="post" action="{{ url_for('superadmin.tenant_unblock', tenant_id=tenant.id) }}" class="d-inline">
      <button class="btn btn-success btn-sm">Desbloquear</button>
    </form>
  {% else %}
    <form method="post" action="{{ url_for('superadmin.tenant_block', tenant_id=tenant.id) }}" class="d-inline">
      <button class="btn btn-warning btn-sm">Bloquear</button>
    </form>
  {% endif %}
  <form method="post" action="{{ url_for('superadmin.tenant_delete', tenant_id=tenant.id) }}" class="d-inline"
        onsubmit="return confirm('Tem certeza que deseja excluir TUDO desse tenant?');">
    <button class="btn btn-outline-danger btn-sm">Excluir</button>
  </form>
{% endblock %}

{% block page_content %}
<div class="row g-3">
  <div class="col-12 col-lg-3">
    <div class="ff-card p-3">
      <div class="ff-muted small">Reservas (7d)</div>
      <div class="ff-metric">{{ kpi.res_7d }}</div>
    </div>
  </div>
  <div class="col-12 col-lg-3">
    <div class="ff-card p-3">
      <div class="ff-muted small">Reservas (30d)</div>
      <div class="ff-metric">{{ kpi.res_30d }}</div>
    </div>
  </div>
  <div class="col-12 col-lg-3">
    <div class="ff-card p-3">
      <div class="ff-muted small">Gross (30d)</div>
      <div class="ff-metric">${{ '%.2f' % kpi.gross_30d }}</div>
    </div>
  </div>
  <div class="col-12 col-lg-3">
    <div class="ff-card p-3">
      <div class="ff-muted small">Sua taxa (30d)</div>
      <div class="ff-metric">${{ '%.2f' % kpi.fee_30d }}</div>
    </div>
  </div>

  <div class="col-12">
    <div class="ff-card p-3">
      <div class="row">
        <div class="col-md-6">
          <div><strong>Slug:</strong> <code>{{ tenant.slug }}</code></div>
          <div><strong>Criado em:</strong> {{ tenant.created_at.strftime('%d/%m/%Y %H:%M') if tenant.created_at else '—' }}</div>
          <div><strong>Últ. atividade:</strong> {{ tenant.last_activity_at.strftime('%d/%m/%Y %H:%M') if tenant.last_activity_at else '—' }}</div>
        </div>
        <div class="col-md-6">
          <div><strong>Status:</strong>
            {% if tenant.is_blocked %}<span class="badge text-bg-warning">Bloqueado</span>
            {% else %}<span class="badge text-bg-success">Ativo</span>{% endif %}
          </div>
          <div class="small ff-muted mt-2">Meta semanal vigente: <strong>2</strong> reservas/tenant.</div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
